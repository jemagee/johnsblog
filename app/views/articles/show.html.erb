<div class="row">
  <h1 class="page-header">
    <%= @article.title %><br />
    <small>
      <% if !@article.category.nil? %>
        Filed under <%= @article.category.name %>
      <% end %>
      <br />
      <% if @article.published? %>
        Published: <%= time_ago_in_words(@article.published_on)%> ago
      <% end %>
    </small>
  </h1>
</div>
<div class="abstract row">
    <%= @article.abstract %>
</div>
<div class="row">
  <div class="article-body">
    <%= redcarpet_process(@article.body) %>
  </div>
</div>
<% if @article.published? %>
  <div class="row">
    <%= render 'comment', article: @article %>
  </div>
  <div class="row">
    <h4><%= @article.comments.count %> Comments</h4> 
    <% @article.comments.each do |msg| %>
      <% unless msg.created_at.blank? %>
        <div id="comment-<%= msg.id %>">
            <span class="comment-time">
              Posted <%= time_ago_in_words(msg.created_at) %> ago
            </span>
            <br />
          <div class="comment-body">
            <%= msg.body %>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>

<% admins_only do %>
  <div class="row" id="admin">
    <div>
      Status: <%= @article.status.upcase %>
    </div>
    <div class="btn-group">
      <%= link_to "Edit Article", edit_admin_article_path(@article), class: "btn btn-xs btn-success" %>
      <% if !@article.published? %>
        <%= link_to "Publish Article", publish_admin_article_path(@article), class: "btn btn-xs btn-info" %>
      <% end %>
      <%= link_to "Delete Article", admin_article_path(@article), method: :delete, data: { confirm: "Are you sure you want to delete this article" }, class: "btn btn-xs btn-danger" %> 
    </div>
  </div>
<% end %>
